    由于雅克比矩阵存在很多很麻烦的地方，所以在机械界有人发明了CCD的方法

### 循环坐标下降法（CCD）
- 游戏中应用的非常多
- 对所有受IK影响的骨骼，从离父骨骼最远的那个子骨骼开始向目标位置转动，当转动到那个角度之后，下一个子骨骼（更靠近父骨骼的那个）开始向这个角度动；如此迭代，直到最终达到目标

#### 优点
- 结果很稳定。
- 计算次数在5-10次，可以提升计算效率

#### 缺点
- 人体很多关节不是能够360°旋转的，所以需要加角度控制
- **特殊情况**：如果所有的骨骼和目标点都在一条直线上，就会陷入僵局，大家都觉得自己不用转动。
	- 解决办法1：关节永远不能伸直
	- 解决办法2：如果发现有些很直，就向允许的方向加一些细微的旋转


### 基于样例的方法（基于构造的统计模型的IK）
	由于IK存在缺陷：尽管所有的关节都符合数学公式，但是看人体的运动却一点都不自然。所以我们需要其他的方法来解决这个问题。
- 深度学习是一种方法，它是基于很多样例的训练数据确定了一个骨骼运动的限制角度、趋势等等内容。
- 基于样例的方法是深度学习方法的基础。虽然没怎么看懂，不过好像通过demo意会到了一些内容。

---

	通常来说，骨骼绑定师的作用就是手动确定一块皮肤受哪几个骨骼多大的影响。但是这是一个很复杂的工作。如何自动绑定是我们要努力的方向。

### 中性姿势或静止姿势
使用T姿态，可以更容易的将皮肤、衣物等的运动函数随着骨骼运动函数的改变而改变。
	
	那么一块皮肤受哪几个骨骼多大的影响呢？比如手肘的位置？

### 顶点混合法（Vertex Blending）
1. 刚体变换：不真实。**解决办法**是使用顶点混合法
2. 柔性的"skin"：这是最简单的方法，前后臂仍然单独设置冬瓜，但关节处用一个柔性的“skin”来连接。这个skin受前后臂的影响

	如何计算权因子？

有一个数学公式
数学公式的意思就是，通过距离来决定权因子大小。
不过这个过程存在问题，线性顶点混合在极端角的地方会形成“关节塌陷”或者“糖果包裹”这样的形象

### 基于样本的权值确定
不是手工确定权值，而是从样本中学习权值

### 自动绑定：骨架计算
#### 主要思想
Pinocchio主要包含的两个过程：
- 首先在未知的三维模型中嵌入骨架
- 然后计算骨骼对表面网格上每个顶点的影响权值，并将表面皮肤依附在骨骼上

#### 怎么自动计算？
- 可以利用物体的中轴
- 可通过圆/球体拟合来计算


	除了上面的方法之外，运动捕获是一个很好的方法
### 运动捕获
历史悠久、电影、游戏经常使用。因为方便、真实、而且快速，比培养人才的成本低
#### 主要思路
跟踪参考点运动并将信息转化为关节角度，用关节角度驱动关节模型，结合运动轨迹，进行角色的控制
#### MOCAP流水线
1. 标定
	- 获取方法：光学、磁性、机械
	- 照相机标定：用棋盘格标定
	- 多个标记点：有些方法（光学等）容易被遮挡
2. 捕获
	- 光学运动捕获系统：包括主动和被动两种
	- 磁性运动捕获系统：精度有限，很重
	- 机械运动捕获系统
3. 三维位置重建
4. 拟合到骨架
5. 后处理

#### 优缺点
- 优点
	1. 只要能被记录，那么运动真实
- 缺点
	1. 不容易进行（编辑、控制）
	2. 贵

## 运用Motion Capture数据
### 两种方法
- 离线
- 在线（表演动画）

### 运动数据的信号处理
#### 运动信号的处理
不同的信号频率刻画了不同的运动
- 低频：基本运动（eg.走路）
- 高频：特质运动（eg.跛行）

#### 运动的操作/编辑/变形
虚拟角色需要被动作驱动，但是演员或者是数据，速度等本来是不匹配的，所以需要运动变形

#### 对信号进行滤波处理
- 把运动看成多维信号
- 低通滤波：去噪
- 高通滤波：风格的变换
- 高频信息可能时运动细节，而不是噪声
- 通过滤波来进行运动的修改会出现问题
	- 可能人本来不能双脚离地，滤波后双脚离地了
	- 可能人的动作本来很自然，滤波后变的不自然了

	怎么解决上面的问题？

### 运动数据的重定向
需要设置重要的约束，并使得投影到不匹配的额虚拟角色上时，能够尽可能生成一个与原始运动接近的新的运动
#### 过程
- 定义约束
- 应用到新的角色
- 加入平移偏移（近似解）
- 解非线性约束优化问题

	此时需要把两端或多段运动加载一起，该怎么做？

### 运动混合
使用插值逐帧进行操作（公式在ppt上）
#### 运动过渡
运动捕获得到的通常时小的运动片段，需要把他们连接起来，就需要运动过渡。如果运动相近，则很容易；如果相差较远，就比较困难

---

## 人脸表情动画
### 逼真人脸表情合成
- 人脸参数化（rigging)：构造一个具有较低维的并且具有直观视觉意义的参数空间，并给定参数空间到表情空间的映射关系
- 比如说，基于blendshape的人脸表情参数化
	所有的表情都可以通过一定权重的基本表情（哭、笑、平静等）给组合起来
- 基于拉普拉斯变形的人脸表情合成
使用特征点驱动，将采集的表演者真实人脸表情变化迁移到一个虚拟的**中性目标人脸模型**上；使用额头部和鼻子两处共6个点的位置，记录头部的刚体运动。

### 脸部运动数据预处理——脸部运动分解
头部刚体运动At（包括旋转Rt和平移矩阵Tt）,和脸部表情Ft之间的关系可以用下面的公式来表示：
	
>	Ft=Rt*Ft'+T

	Ft={Pt1,...,Pt42}:刚体标记点的位置
为了消除在运动捕获过程中刚体标记点产生的微小的非刚体运动，我们在最小二乘意义上计算近似最优的刚体变换。数学公式在ppt上

### 三维模型的获取
	为了能够很好的表现，生成像照片一样真实的三维模型，所以需要生成角色的高精度三维扫描模型
已有系统：面部动作编码系统FACS